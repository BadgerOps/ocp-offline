<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>{{ .Title }} â€” AirGap</title>
	<script src="https://unpkg.com/htmx.org@1.9.10"></script>
	<script defer src="https://unpkg.com/alpinejs@3.13.3/dist/cdn.min.js"></script>
	<script>
		// HTMX+Alpine integration: initialize Alpine components in swapped content
		document.addEventListener('htmx:afterSettle', function(evt) {
			if (window.Alpine && evt.detail.elt) {
				Alpine.initTree(evt.detail.elt);
			}
		});
	</script>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="/static/style.css">
	<style>
		:root {
			--bg-deepest: #0a0e17;
			--bg-deep: #0f1520;
			--bg-surface: #151d2e;
			--bg-elevated: #1a2436;
			--bg-hover: #1f2b40;
			--border-subtle: rgba(255,255,255,0.06);
			--border-medium: rgba(255,255,255,0.1);
			--text-primary: #e8edf5;
			--text-secondary: #8892a4;
			--text-muted: #555f73;
			--accent: #00d4aa;
			--accent-dim: rgba(0,212,170,0.15);
			--accent-glow: rgba(0,212,170,0.3);
			--red: #ff4d6a;
			--red-dim: rgba(255,77,106,0.15);
			--amber: #ffb84d;
			--amber-dim: rgba(255,184,77,0.15);
			--blue: #4d94ff;
			--blue-dim: rgba(77,148,255,0.15);
			--font-mono: 'IBM Plex Mono', monospace;
			--font-sans: 'IBM Plex Sans', sans-serif;
			--radius: 8px;
			--radius-lg: 12px;
		}

		/* Light theme overrides */
		html.light-theme {
			--bg-deepest: #f5f6f8;
			--bg-deep: #ffffff;
			--bg-surface: #ffffff;
			--bg-elevated: #f0f1f3;
			--bg-hover: #e8eaed;
			--border-subtle: rgba(0,0,0,0.08);
			--border-medium: rgba(0,0,0,0.15);
			--text-primary: #1a1d23;
			--text-secondary: #5a6270;
			--text-muted: #8c939e;
			--accent: #00a884;
			--accent-dim: rgba(0,168,132,0.1);
			--accent-glow: rgba(0,168,132,0.2);
			--red: #e53e56;
			--red-dim: rgba(229,62,86,0.1);
			--amber: #d4920a;
			--amber-dim: rgba(212,146,10,0.1);
			--blue: #2b6fd4;
			--blue-dim: rgba(43,111,212,0.1);
		}

		html.light-theme .sidebar {
			box-shadow: 1px 0 3px rgba(0,0,0,0.05);
		}

		html.light-theme .card {
			box-shadow: 0 1px 3px rgba(0,0,0,0.06);
		}

		html.light-theme .content::-webkit-scrollbar-thumb {
			background: rgba(0,0,0,0.15);
		}

		html.light-theme .content::-webkit-scrollbar-thumb:hover {
			background: rgba(0,0,0,0.25);
		}

		* { margin: 0; padding: 0; box-sizing: border-box; }

		html, body {
			height: 100%;
			font-family: var(--font-sans);
			color: var(--text-primary);
			background-color: var(--bg-deepest);
			-webkit-font-smoothing: antialiased;
		}

		body { display: flex; }

		/* Sidebar */
		.sidebar {
			width: 240px;
			background: var(--bg-deep);
			border-right: 1px solid var(--border-subtle);
			padding: 0;
			display: flex;
			flex-direction: column;
			flex-shrink: 0;
		}

		.sidebar-brand {
			padding: 24px 24px 20px;
			border-bottom: 1px solid var(--border-subtle);
		}

		.sidebar-brand h1 {
			font-family: var(--font-mono);
			font-size: 18px;
			font-weight: 600;
			letter-spacing: 0.05em;
			color: var(--accent);
		}

		.sidebar-brand .brand-sub {
			font-size: 11px;
			color: var(--text-muted);
			font-family: var(--font-mono);
			margin-top: 4px;
			letter-spacing: 0.08em;
			text-transform: uppercase;
		}

		.sidebar nav {
			padding: 12px 0;
			flex: 1;
		}

		.sidebar nav a {
			display: flex;
			align-items: center;
			gap: 12px;
			padding: 10px 24px;
			color: var(--text-secondary);
			text-decoration: none;
			font-size: 14px;
			font-weight: 400;
			transition: all 0.15s ease;
			border-left: 2px solid transparent;
		}

		.sidebar nav a:hover {
			color: var(--text-primary);
			background: var(--bg-hover);
		}

		.sidebar nav a.active {
			color: var(--accent);
			background: var(--accent-dim);
			border-left-color: var(--accent);
			font-weight: 500;
		}

		.sidebar nav a .nav-icon {
			width: 18px;
			height: 18px;
			opacity: 0.6;
			flex-shrink: 0;
		}

		.sidebar nav a.active .nav-icon { opacity: 1; }

		.sidebar-footer {
			padding: 16px 24px;
			border-top: 1px solid var(--border-subtle);
			font-size: 11px;
			color: var(--text-muted);
			font-family: var(--font-mono);
		}

		/* Main Content */
		.main-container {
			flex: 1;
			display: flex;
			flex-direction: column;
			overflow: hidden;
			min-width: 0;
		}

		.header {
			background: var(--bg-deep);
			border-bottom: 1px solid var(--border-subtle);
			padding: 20px 32px;
			display: flex;
			align-items: center;
			justify-content: space-between;
		}

		.header h1 {
			font-family: var(--font-sans);
			font-size: 20px;
			font-weight: 500;
			color: var(--text-primary);
		}

		.header-meta {
			font-family: var(--font-mono);
			font-size: 12px;
			color: var(--text-muted);
		}

		.content {
			flex: 1;
			overflow-y: auto;
			padding: 32px;
			background:
				radial-gradient(circle at 50% 0%, rgba(0,212,170,0.03) 0%, transparent 50%),
				var(--bg-deepest);
		}

		/* Scrollbar */
		.content::-webkit-scrollbar { width: 6px; }
		.content::-webkit-scrollbar-track { background: transparent; }
		.content::-webkit-scrollbar-thumb { background: var(--border-medium); border-radius: 3px; }
		.content::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

		/* Cards */
		.card {
			background: var(--bg-surface);
			border: 1px solid var(--border-subtle);
			border-radius: var(--radius-lg);
			padding: 24px;
			margin-bottom: 20px;
			animation: cardIn 0.3s ease both;
		}

		@keyframes cardIn {
			from { opacity: 0; transform: translateY(8px); }
			to { opacity: 1; transform: translateY(0); }
		}

		.card h2 {
			font-family: var(--font-sans);
			font-size: 15px;
			font-weight: 600;
			color: var(--text-primary);
			margin-bottom: 4px;
			letter-spacing: -0.01em;
		}

		.card .card-desc {
			font-size: 13px;
			color: var(--text-secondary);
			margin-bottom: 16px;
		}

		/* Status Grid */
		.status-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
			gap: 16px;
		}

		.status-card {
			background: var(--bg-surface);
			border: 1px solid var(--border-subtle);
			border-radius: var(--radius-lg);
			padding: 20px;
			position: relative;
			overflow: hidden;
			transition: border-color 0.2s, box-shadow 0.2s;
			animation: cardIn 0.3s ease both;
		}

		.status-card:hover {
			border-color: var(--border-medium);
			box-shadow: 0 4px 24px rgba(0,0,0,0.2);
		}

		.status-card::before {
			content: '';
			position: absolute;
			top: 0; left: 0; bottom: 0;
			width: 3px;
		}

		.status-card.enabled::before { background: var(--accent); }
		.status-card.disabled::before { background: var(--text-muted); }

		.status-card h3 {
			font-family: var(--font-mono);
			font-size: 14px;
			font-weight: 600;
			color: var(--text-primary);
			margin-bottom: 12px;
		}

		.status-card .info {
			font-size: 13px;
			color: var(--text-secondary);
			line-height: 1.7;
		}

		.status-card .info strong {
			color: var(--text-muted);
			font-weight: 500;
			font-size: 11px;
			text-transform: uppercase;
			letter-spacing: 0.05em;
		}

		/* Badges */
		.badge {
			display: inline-block;
			padding: 2px 8px;
			border-radius: 4px;
			font-family: var(--font-mono);
			font-size: 11px;
			font-weight: 500;
		}

		.badge-enabled, .badge-success, .badge-completed {
			background: var(--accent-dim);
			color: var(--accent);
		}

		.badge-disabled, .badge-muted {
			background: rgba(255,255,255,0.05);
			color: var(--text-muted);
		}

		.badge-error, .badge-failed {
			background: var(--red-dim);
			color: var(--red);
		}

		.badge-warning, .badge-running {
			background: var(--amber-dim);
			color: var(--amber);
		}

		.badge-info, .badge-export {
			background: var(--blue-dim);
			color: var(--blue);
		}

		.badge-import {
			background: var(--accent-dim);
			color: var(--accent);
		}

		/* Tables */
		table {
			width: 100%;
			border-collapse: collapse;
		}

		table thead {
			border-bottom: 1px solid var(--border-medium);
		}

		table th {
			padding: 10px 16px;
			text-align: left;
			font-family: var(--font-mono);
			font-size: 11px;
			font-weight: 500;
			color: var(--text-muted);
			text-transform: uppercase;
			letter-spacing: 0.06em;
		}

		table td {
			padding: 10px 16px;
			font-size: 13px;
			border-bottom: 1px solid var(--border-subtle);
			color: var(--text-secondary);
		}

		table tr:hover td {
			background: var(--bg-hover);
			color: var(--text-primary);
		}

		table a {
			color: var(--accent);
			text-decoration: none;
		}

		table a:hover { text-decoration: underline; }

		/* Buttons */
		.btn {
			display: inline-flex;
			align-items: center;
			gap: 6px;
			padding: 8px 16px;
			border: 1px solid var(--border-medium);
			border-radius: var(--radius);
			cursor: pointer;
			font-family: var(--font-sans);
			font-size: 13px;
			font-weight: 500;
			background: var(--bg-elevated);
			color: var(--text-primary);
			transition: all 0.15s ease;
			text-decoration: none;
			line-height: 1.4;
		}

		.btn:hover {
			background: var(--bg-hover);
			border-color: var(--text-muted);
		}

		.btn-primary {
			background: var(--accent);
			color: var(--bg-deepest);
			border-color: var(--accent);
			font-weight: 600;
		}

		.btn-primary:hover {
			background: #00e6b8;
			border-color: #00e6b8;
			box-shadow: 0 0 20px var(--accent-glow);
		}

		.btn-danger {
			border-color: var(--red);
			color: var(--red);
			background: transparent;
		}

		.btn-danger:hover {
			background: var(--red-dim);
		}

		.btn-sm {
			padding: 5px 10px;
			font-size: 12px;
		}

		.btn-group {
			display: flex;
			gap: 8px;
			flex-wrap: wrap;
			align-items: center;
		}

		/* HTMX loading */
		.htmx-indicator {
			display: none;
			font-family: var(--font-mono);
			font-size: 12px;
			color: var(--accent);
		}

		.htmx-request .htmx-indicator {
			display: inline-flex;
			align-items: center;
			gap: 6px;
		}

		.htmx-indicator::before {
			content: '';
			width: 12px; height: 12px;
			border: 2px solid var(--accent-dim);
			border-top-color: var(--accent);
			border-radius: 50%;
			animation: spin 0.6s linear infinite;
		}

		@keyframes spin {
			to { transform: rotate(360deg); }
		}

		/* Forms */
		.form-group {
			margin-bottom: 16px;
		}

		.form-group label {
			display: block;
			margin-bottom: 6px;
			font-size: 12px;
			font-weight: 500;
			color: var(--text-secondary);
			text-transform: uppercase;
			letter-spacing: 0.04em;
			font-family: var(--font-mono);
		}

		.form-input,
		.form-group input[type="text"],
		.form-group select,
		.form-group textarea {
			width: 100%;
			padding: 9px 12px;
			border: 1px solid var(--border-medium);
			border-radius: var(--radius);
			font-size: 13px;
			font-family: var(--font-sans);
			background: var(--bg-deep);
			color: var(--text-primary);
			transition: border-color 0.15s, box-shadow 0.15s;
		}

		.form-group input[type="text"]:focus,
		.form-group select:focus,
		.form-group textarea:focus {
			outline: none;
			border-color: var(--accent);
			box-shadow: 0 0 0 3px var(--accent-dim);
		}

		.form-group input[type="text"]::placeholder {
			color: var(--text-muted);
		}

		.form-group select {
			cursor: pointer;
		}

		.form-group select option {
			background: var(--bg-surface);
			color: var(--text-primary);
		}

		.form-row {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 16px;
		}

		/* Checkbox styling */
		input[type="checkbox"] {
			accent-color: var(--accent);
			width: 15px;
			height: 15px;
			cursor: pointer;
		}

		input[type="radio"] {
			accent-color: var(--accent);
			cursor: pointer;
		}

		/* Alerts */
		.alert {
			padding: 12px 16px;
			border-radius: var(--radius);
			margin-top: 12px;
			font-size: 13px;
			border: 1px solid;
		}

		.alert-success {
			background: var(--accent-dim);
			color: var(--accent);
			border-color: rgba(0,212,170,0.2);
		}

		.alert-error {
			background: var(--red-dim);
			color: var(--red);
			border-color: rgba(255,77,106,0.2);
		}

		.alert-info {
			background: var(--blue-dim);
			color: var(--blue);
			border-color: rgba(77,148,255,0.2);
		}

		/* Responsive */
		@media (max-width: 768px) {
			body { flex-direction: column; }

			.sidebar {
				width: 100%;
				flex-direction: row;
				align-items: center;
				border-right: none;
				border-bottom: 1px solid var(--border-subtle);
			}

			.sidebar-brand { padding: 12px 16px; border-bottom: none; }
			.sidebar-brand .brand-sub { display: none; }

			.sidebar nav {
				display: flex;
				padding: 0;
				overflow-x: auto;
			}

			.sidebar nav a {
				padding: 12px 16px;
				border-left: none;
				border-bottom: 2px solid transparent;
				white-space: nowrap;
				font-size: 13px;
			}

			.sidebar nav a.active {
				border-left-color: transparent;
				border-bottom-color: var(--accent);
			}

			.sidebar nav a .nav-icon { display: none; }
			.sidebar-footer { display: none; }

			.status-grid { grid-template-columns: 1fr; }
			.content { padding: 16px; }
			.header { padding: 16px; }
			.header h1 { font-size: 16px; }
			.form-row { grid-template-columns: 1fr; }
		}

		/* Stagger animation for grid children */
		.status-grid > *:nth-child(1) { animation-delay: 0s; }
		.status-grid > *:nth-child(2) { animation-delay: 0.05s; }
		.status-grid > *:nth-child(3) { animation-delay: 0.1s; }
		.status-grid > *:nth-child(4) { animation-delay: 0.15s; }
		.status-grid > *:nth-child(5) { animation-delay: 0.2s; }
		.status-grid > *:nth-child(6) { animation-delay: 0.25s; }
	</style>
</head>
<body>
	<aside class="sidebar">
		<div class="sidebar-brand">
			<h1>AIRGAP</h1>
			<div class="brand-sub">Offline Sync</div>
		</div>
		<nav>
			<a href="/dashboard" class="nav-link">
				<svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
				Dashboard
			</a>
			<a href="/providers" class="nav-link">
				<svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
				Providers
			</a>
			<a href="/ocp/clients" class="nav-link">
				<svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 17l6-6-6-6"/><path d="M12 19h8"/></svg>
				OCP Clients
			</a>
			<a href="/sync" class="nav-link">
				<svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
				Sync Status
			</a>
			<a href="/transfer" class="nav-link">
				<svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
				Transfer
			</a>
		</nav>
		<div class="sidebar-footer">
			{{if .Version}}{{.Version}}{{else}}dev{{end}}
		</div>
	</aside>

	<div class="main-container">
		<header class="header">
			<h1>{{ .Title }}</h1>
			<button onclick="toggleTheme()" class="btn btn-sm"
				style="display: inline-flex; align-items: center; gap: 6px; font-size: 12px;"
				title="Toggle light/dark mode">
				<svg id="theme-icon-dark" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
				<svg id="theme-icon-light" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none;"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
			</button>
		</header>

		<main class="content">
			{{block "content" .}}{{end}}
		</main>
	</div>

	<script>
		document.addEventListener('DOMContentLoaded', function() {
			const currentPath = window.location.pathname;
			const links = document.querySelectorAll('.sidebar nav a');
			links.forEach(link => {
				const href = link.getAttribute('href');
				if (currentPath === href || currentPath.startsWith(href + '/')) {
					link.classList.add('active');
				} else {
					link.classList.remove('active');
				}
			});
		});

		function formatBytes(bytes) {
			if (!bytes || bytes <= 0 || !isFinite(bytes)) return '0 B';
			const k = 1024;
			const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
			const i = Math.floor(Math.log(bytes) / Math.log(k));
			return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
		}

		function syncProgress() {
			return {
				progress: {
					phase: 'planning', percent: 0, total_files: 0, completed_files: 0,
					failed_files: 0, skipped_files: 0, total_bytes: 0, bytes_downloaded: 0,
					elapsed: '0s', message: 'Starting...', current_files: [],
					recent_events: [], total_retries: 0, bytes_per_second: 0, eta: '', provider: ''
				},
				eventSource: null,
				filesExpanded: false,
				logExpanded: false,
				start() {
					this.eventSource = new EventSource('/api/sync/progress');
					this.eventSource.addEventListener('progress', (e) => {
						this.progress = JSON.parse(e.data);
					});
					this.eventSource.addEventListener('done', (e) => {
						this.progress = JSON.parse(e.data);
						this.eventSource.close();
						window.dispatchEvent(new CustomEvent('sync-done', { detail: this.progress }));
					});
					this.eventSource.onerror = () => {
						this.eventSource.close();
					};
				},
				alertClass() {
					if (this.progress.phase === 'complete') return 'alert-success';
					if (this.progress.phase === 'failed' || this.progress.phase === 'cancelled') return 'alert-error';
					return 'alert-info';
				},
				phaseBadge() {
					if (this.progress.phase === 'complete') return 'badge-success';
					if (this.progress.phase === 'failed' || this.progress.phase === 'cancelled') return 'badge-error';
					return 'badge-running';
				},
				formatBytes(b) { return formatBytes(b); }
			};
		}

		function failedFilesPanel() {
			return {
				failures: [],
				retrying: false,
				clearingBatch: false,
				selectedIds: [],
				_provider: '',
				_listening: false,
				async load(provider) {
					if (!provider) return;
					this._provider = provider;
					try {
						const resp = await fetch('/api/sync/failures?provider=' + encodeURIComponent(provider));
						if (resp.ok) {
							this.failures = await resp.json() || [];
							const current = new Set(this.failures.map(f => f.ID));
							this.selectedIds = this.selectedIds.filter(id => current.has(id));
						}
					} catch(e) { console.error('Failed to load failures:', e); }
					if (!this._listening) {
						this._listening = true;
						window.addEventListener('sync-done', () => {
							this.load(this._provider);
							this.retrying = false;
							this.clearingBatch = false;
						});
					}
				},
				toggleSelected(id, checked) {
					if (checked) {
						if (!this.selectedIds.includes(id)) this.selectedIds.push(id);
						return;
					}
					this.selectedIds = this.selectedIds.filter(x => x !== id);
				},
				toggleSelectAll(checked) {
					if (!checked) {
						this.selectedIds = [];
						return;
					}
					this.selectedIds = this.failures.map(f => f.ID);
				},
				async retry(provider) {
					if (!provider) return;
					this.retrying = true;
					try {
						await fetch('/api/sync/retry', {
							method: 'POST',
							headers: {'Content-Type': 'application/json'},
							body: JSON.stringify({provider: provider})
						});
					} catch(e) {
						console.error('Retry failed:', e);
						this.retrying = false;
					}
				},
				async resolve(provider, ids, all) {
					if (!provider) return;
					if (!all && (!ids || ids.length === 0)) return;
					this.clearingBatch = true;
					try {
						const body = { provider: provider, all: !!all };
						if (!all) body.ids = ids;
						const resp = await fetch('/api/sync/failures/resolve', {
							method: 'POST',
							headers: {'Content-Type': 'application/json'},
							body: JSON.stringify(body)
						});
						if (resp.ok) {
							await this.load(provider);
							if (all) {
								this.selectedIds = [];
							} else {
								const cleared = new Set(ids);
								this.selectedIds = this.selectedIds.filter(id => !cleared.has(id));
							}
						}
					} catch (e) {
						console.error('Clear failed:', e);
					} finally {
						this.clearingBatch = false;
					}
				},
				async clearSelected(provider) {
					await this.resolve(provider, this.selectedIds, false);
				},
				async clearAll(provider) {
					await this.resolve(provider, [], true);
				}
			};
		}
		// Theme toggle
		function toggleTheme() {
			const html = document.documentElement;
			const isLight = html.classList.toggle('light-theme');
			localStorage.setItem('theme', isLight ? 'light' : 'dark');
			updateThemeIcons(isLight);
		}

		function updateThemeIcons(isLight) {
			const darkIcon = document.getElementById('theme-icon-dark');
			const lightIcon = document.getElementById('theme-icon-light');
			if (darkIcon && lightIcon) {
				darkIcon.style.display = isLight ? 'none' : 'block';
				lightIcon.style.display = isLight ? 'block' : 'none';
			}
		}

		// Apply saved theme on load (before DOMContentLoaded to avoid flash)
		(function() {
			const saved = localStorage.getItem('theme');
			if (saved === 'light') {
				document.documentElement.classList.add('light-theme');
			}
		})();

		// Update icons after DOM is ready
		document.addEventListener('DOMContentLoaded', function() {
			updateThemeIcons(document.documentElement.classList.contains('light-theme'));
		});
	</script>
</body>
</html>
